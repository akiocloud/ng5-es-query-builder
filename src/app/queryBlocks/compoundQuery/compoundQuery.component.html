<style>
	div.warn 
	{
		background: purple;
		padding: 10px;
	}
	div.warn * 
	{
		vertical-align: middle;
		color: white;
	}
</style>
		

<!--
<div>
</div>
<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
-->

<div class="form-group single_query col-xs-12 bool_query">

	<div class="warn" *ngFor="let err of query.errors">
		<i class="material-icons"> warning </i>
		<span style="padding-left:6px;font-size:medium;"> {{ err }} </span>
	</div>
		
	
	<div class="action-btn-group bool-btn-group">
		<a href="javascript:void(0)" (click)="removeInQuery(query.id)" class="btn btn-grey delete-nested-query">
			<i class="fa fa-times"></i>
		</a>
	</div>
	<div class="row m-b15 nested-first">

		<div class="col-xs-6">

			<mat-form-field>
				<mat-select
					placeholder="Query"
					[(value)]="query.boolparam"
					(change)="exeBuild()">

					<mat-option
						*ngFor="let compoundQuery of queryList.compoundQuery; let i = index;" 
						[value]="compoundQuery">{{ compoundQuery }}</mat-option>
				</mat-select>
			</mat-form-field>
			
		</div>

		<div class="col-xs-6"><!--  -->
			<div class="form-group form-element" *ngIf="query.boolparam == 'should'">
				<input type="text" class="form-control" placeholder="Minimum should match" [(ngModel)] = "query.minimum_should_match"  (keyup)="exeBuild();" />
			</div>
			<div class="form-group form-element" *ngIf="query.boolparam == 'span_near'">
				<input type="text" class="form-control" placeholder="Slop" [(ngModel)] = "query.slop"  (keyup)="exeBuild();" />
			</div>
			<div class="form-group form-element" *ngIf="query.boolparam == 'span_near'">
				<!-- <input type="text" class="form-control" placeholder="In Order" [(ngModel)] = "query.in_order"  (keyup)="exeBuild();" /> -->
				<mat-form-field>
					<mat-select
						placeholder="In Order"
						[(value)]="query.in_order"
						(change)="exeBuild()">
						<mat-option [value]="true"> True </mat-option>
						<mat-option [value]="false"> False </mat-option>
						<mat-option [value]=""> &nbsp; </mat-option>
					</mat-select>
				</mat-form-field>

			</div>

		</div>

	</div>

	<div class="internvalQuery">
		<form class="row m-0"
		 *ngFor="let queryIn of query.internal, let internalIndex=index">
			<single-query 
				[mapping]="mapping"
				[types]="types"
				[selectedTypes]="selectedTypes" 
				[result]="result" 
				[config]="config" 
				[query]="queryIn" 
				[queryList]="queryList"
				[internalIndex]="internalIndex"
				[queryIndex]="query.id"
				[internal]="query.internal"
				[buildQuery]="buildQuery"
				[buildInsideQuery]="buildInsideQuery"
				[buildSubQuery]="buildSubQuery"
				[createQuery]="createQuery"
				[setQueryFormat]="setQueryFormat"
				[compoundQueryName]="query.boolparam"
				(setDocSample)="setDocSampleEve($event);">
			</single-query>
		</form>
	</div>
	<div class="col-xs-12 add_condition_row">
		<button mat-raised-button (click)="addQuery(query)">
			<i class="fa fa-plus"></i> Conditions
		</button>
	</div>
	<div class="subQuery col-xs-12">
		<form class="row m-0" *ngFor="let queryIn of result.resultQuery.result">
			<div *ngIf="queryIn.parent_id != 0 && queryIn.parent_id == query.id">
				<compound-query 
					[mapping]="mapping"
					[types]="types"
					[selectedTypes]="selectedTypes" 
					[result]="result" 
					[config]="config" 
					[query]="queryIn" 
					[queryList]="queryList"
					[addQuery]="addQuery"
					[addCompoundQuery]="addCompoundQuery"
					[removeQuery]="removeQuery"
					[queryFormat]="queryFormat"
					[buildQuery]="buildQuery"
					[buildInsideQuery]="buildInsideQuery"
					[buildSubQuery]="buildSubQuery"
					[createQuery]="createQuery"
					[setQueryFormat]="setQueryFormat" >
				</compound-query>
			</div>
		</form>
	</div>
	<div>

		<button mat-raised-button (click)="addSubQuery(query.id)">
			<i class="fa fa-plus"></i> Sub Query
		</button>
		
	</div>
</div>